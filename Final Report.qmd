---
title: "Housing discrimination in the Mumbai Metropolitan Region - a spatial analysis of caste-based segregation"
author: "Aaditya Warrier"
bibliography: references.bib
format: pdf
editor: visual
editor_options: 
  chunk_output_type: console
---

```{r setup, echo = FALSE, include = FALSE, warning=FALSE}
library(tidyverse)
library(sf)
library(knitr)
opts_chunk$set(warning = FALSE, echo = FALSE)
```

## 1. Introduction

Mumbai, India's financial and commercial capital, is both its wealthiest city and its most diverse. The current capital of Maharashtra and the former headquarters of the Bombay Presidency during British rule - which at its peak extended as far as present-day Sindh in Pakistan - the city has long been home to large minority communities, but was always dominated by Maharashtrians and Gujaratis, who comprised a bulk of the natives of the region. Post-independence, however, the city was (and continues to be) shaped by waves of immigration from across the state and the country, exponentially growing its population and consequently its urbanized area to accommodate these new residents. Large swathes of land to the north of the city, previously independent towns or villages, were annexed by administration, with sprawl oriented around the three major railway lines emanating from the historic city. Mumbai is no stranger to expansion - indeed, the original island city owes its mere existence to land reclamation by the British - but its scale and scope in the past few decades has been unprecedented. In 1951, the city covered 231.5 $km^2$ and housed 2.3 million people. By 2011, the city's metropolitan region (henceforth shortened as MMR) spanned 6,328 $km^2$ with 22.8 million people, with the city proper housing 12.2 million over a mere 603 $km^2$. Today, Maharashtrians and Gujaratis only make up 42% and 19% of the city's population respectively, the rest being natives of other states.

These rapid changes in demography have brought with them a significant rise in ethnic, religious, and caste tension.

At the same time, real estate prices tend to decrease as one moves north and east, effectively pricing out and incentivizing those shut out of the city's restrictive market to seek housing

Daily commutes of three hours or more are common

The state was the center of the caste movement

Combined with rising real estate prices, these have manifested in social segregation

Lower-caste Hindus, especially non-Brahmin Maharashtrians, are more likely to be non-vegetarian

The existence of widespread discrimination in Mumbai's housing market has been well-established in the literature [@Shaban2021], despite recent laws that have attempted to curb the practice [@Koppikar_2023]. However, little analysis has been conducted on segregation in the wider metropolitan region, outside the boundaries of the city proper.

This project aims to explore to what extent Dalits and other lower caste groups have been pushed to the margins s

The primary objective of the project is descriptive rather than inferential or predictive

using smaller areal units

[see @BHARATHI2023110951]

## 2. Data

The data used in this study comes from The Socioeconomic High-resolution Rural-Urban Geographic Platform for India Project (abbrv. SHRUG). SHRUG is an open access repository that aims to link hundreds of Indian datasets comprising socio-economic surveys, censuses, and environmental studies with common geographic identifiers. Owing to the nation's size and diversity, Indian record-keeping is notoriously inconsistent, with formats, naming conventions, and even languages often differing within the same state; SHRUG circumvents this issue through its standardization process. It also obtains a level of geographic granulality that cannot be found in any single government dataset - by splitting the nation into 576,153 uniform areal units termed "shrids" and reaggregating all variables to these, it provides a largely consistent framework by which to analyse different regions at a deeper level than states, districts and sub-districts. It is for this reason that the project utilizes **2011 Population Census Abstract (PCA) and Socio-Economic and Caste Survey (SECC) Data** [@pcindia; @ecindia; @almn2021] over more recent data like the National Family Health Survey from 2019-21 - cleaning the latter to a level acceptable for analysis would have been a months-long project, as it is not currently available in SHRUG. Yielding the granularity desired for our purposes would indeed be an even more Herculean task.

The 2011 PCA and SECC datasets are the most current census data available for India; although usually conducted decennially, the 2021 census was postponed due to COVID and other political reasons. As stored at the shrid-level in SHRUG, they contain a multitude of variables on employment, occupation, literacy, property ownership, and consumption, as well as demographic information like gender, caste, income, and education status. Key variables of interest were the Scheduled Caste/Scheduled Tribe (SC/ST) population percentages, home/land ownership shares, average number of rooms in home, and share of households with an income above Rs. 5000/10000 a month. SC/ST are government designations for Dalits and Adivasis - Dalits, commonly known as "Untouchables" outside of India, form the lowest rung of the Indian caste system, historically relegated to the most humiliating occupations and subject to severe societal ostracization, while the Adivasis are tribal groups, who while not affected by considerations of "impurity" as with Dalits, are economically disenfranchised and whose cultural practices are seen as "primitive" by much of the rest of Indian society.

Surprisingly missing from the dataset was a breakdown of religions and ethnicities in each shrid. This could have provided additional nuance to our analysis, especially when looking at how they intersect with caste; contrary to popular belief, many non-Hindu Indians also have caste distinctions, while an ethnic breakdown could contextualize discrimination in terms of the familiarity of individuals with specific sub-castes not present in their native regions.

### 2.1 Data Cleaning

As SHRUG stores district/sub-district data separately from shrid-level data, with no linking variables between the two, finding the specific shrids that comprised the MMR outside of the city proper proved a challenge. This was compounded by the fact that the MMR is defined by the Municipal Corporation and Councils that comprise it, the exact boundaries for which occasionally span multiple state-level districts or include very small portions of specific sub-districts. To rectify this problem as much as possible, the spatial intersection (using the st_interescts predicate) between the most relevant sub-districts of the MMR and all shrids in the PCA data was computed. This, however, missed out on a few areas of interest, most notably the majority of the municipal council of Khopoli, while including a few parcels of rural land that were not relevant. The cleaned dataset contained 1273 shrids with a population totaling roughly 22.1 million - this was deemed an acceptable enough difference from the true population of 22.8 million.

Another issue encountered was that the city proper was only comprised of two shrids, each spanning the Mumbai City and Mumbai Suburban districts respectively. The authors of SHRUG note this as an issue in their documentation - specifically, that breaking up census data into shrids was challenging in and around major cities, given the occasional lack of detail in the census - and this hampered some of the comparative analysis that was planned with regards to segregation in the city vs. the rest of the MMR.

Finally, there were some missing shrids in the SECC datasets as compared to the PCA dataset. The rural and urban phases of the SECC were conducted separately, with survey questions slightly different for each; when attempting to merge both datasets with the MMR shrids computed from PCA data, 42 shrids were not found. As a result, only PCA variables are available for those vs. the full set of PCA and SECC variables for the rest.

### 2.2 Exploration

```{r echo  =FALSE, warning=FALSE}
mmr_shrid <- readRDS("data/cleaned/mmr_shrid.rds")

tab <- mmr_shrid |>
  filter(is.na(shrid2)) |>
  summarize(sc_pop = (sum(pc11_pca_p_sc) / sum(pc11_pca_tot_p))* 100,
            st_pop = (sum(pc11_pca_p_st) / sum(pc11_pca_tot_p)) *100, 
            total = sc_pop + st_pop) |>
  as_tibble() |>
  select(-geometry) |>
  rbind(mmr_shrid |>
  summarize(sc_pop = (sum(pc11_pca_p_sc) / sum(pc11_pca_tot_p))* 100,
            st_pop = (sum(pc11_pca_p_st) / sum(pc11_pca_tot_p)) *100, 
            total = sc_pop + st_pop) |>
  as_tibble() |>
  select(-geometry)) |>
  rbind(mmr_shrid |>
          filter(!is.na(shrid2)) |>
  summarize(sc_pop = (sum(pc11_pca_p_sc) / sum(pc11_pca_tot_p))* 100,
            st_pop = (sum(pc11_pca_p_st) / sum(pc11_pca_tot_p)) *100,
            total = sc_pop + st_pop) |>
     as_tibble() |>
  select(-geometry)) |>
  rbind(c(0.166 *100, 0.086 *100, (0.166 + 0.086)*100)) 

rownames(tab) <- c("Mumbai (city proper)", "MMR", "MMR (excluding city proper)", "India")

tab |>
  rownames_to_column() |>
  kable(digits = 2, col.names = c("Region", "SC Population (% of total)", "ST Population (% of total)", "Combined SC/ST Population (% of total)"), 
        row.names = TRUE, caption = "Caste demography of the MMR vs. India")
```



```{r echo = FALSE, warning=FALSE}

ggplot() + 
  geom_sf(data = mmr_shrid |>
  # filter(shrid2 != ) |>
  mutate(sc_st_prop = (pc11_pca_p_sc + pc11_pca_p_st) / 
                                  pc11_pca_tot_p),
  aes(fill = sc_st_prop), color = ifelse(is.na(mmr_shrid$shrid2), "red", NA)) +
  scale_fill_viridis_c() + 
  labs(fill = "Proportion of SC/ST residents") 


mmr_shrid |> 
  filter(is.na(mmr_shrid$shrid2)) |>
  as_tibble() |>
  select(-geometry) |>
  reframe((pc11_pca_p_sc + pc11_pca_p_st) / 
                                  pc11_pca_tot_p)
```

Table 1 displays a breakdown of caste percentages

This is confirmed by Figure 1, which displays a chloropleth-map of all regions of the MMR (including Mumbai City/Suburban districts). As before, note that all of the city proper is are two large shrids, outlined in red on the map. We observe a pattern of increasing SC/ST percentages as we move northwards from the original island city

with high percentages observed in the Kalyan and Bhiwandi districts as well as parts of Vasai and Virar. A similar trend is observed to the east in Karjat and Panvel as well as the souhermost parts of Alibag/Pen district.

This reinforces initial speculation as to the pricing out

This indicates

```{r}
mmr_shrid_2 <- mmr_shrid |>
  filter(shrid2 != "11-27-518-99999-802794")

A = spdep::mat2listw(st_touches(mmr_shrid_2, sparse=FALSE), zero.policy = TRUE)

broom::tidy(spdep::geary.test((mmr_shrid_2$pc11_pca_p_sc + mmr_shrid_2$pc11_pca_p_st) / 
                                  mmr_shrid_2$pc11_pca_tot_p, A)) |>
  select(estimate1, p.value) |>
  kable(digits = 3, col.names = c("Geary's C", "P-value")) |>
  kableExtra::kable_styling(font_size = 9)
  
```

Conducting a hypothesis test for Geary's C shows us clear evidence of positive spatial autocorrelation, indicating that a shrid with a high SC/ST proportion is likely to neighbor a shrid with a very similar proportion. These set the context

## 3. Spatial Analysis

### 3.1 Methodology

#### 3.1.1 Primary Outcome

The primary outcome of this study is the global spatial dissimilarity index, as formulated in [@Reardon_2004], of SC/ST individuals vs. all other individuals. A spatial analog to the dissimilarity index

will be tested across different bandwidths

This index was chosen for its prior use in the Indian context [see @Haque_2021, which explores spatial segregation in Kolkata and Bengaluru] as well as its ability to mitigate the so-called "checkerboard problem" [@Reardon_2004], of great importance in a city like Mumbai where expansions of its territory and local geography have been shaped significantly by different waves of immigration.

These metrics were calculated using the *seg* package in R, developed in part by O'Sullivan. As the *seg* package has been temporarily unavailable on CRAN since Feb 2024 due to dependency issues, an older version of the package available on the archive was used instead; the tar.gz can be found in the project repo.

Significance will be tested using a pseudo-significance "p-value" measure, computed on random permutation tests of dissimilarity across different spatial arrangements of the region [using the procedure described in @Feitosa_2007 pp. 309-310, which was computed on a very similar index].

Avoid the "grid" problem - use subdistrict breakup as well??

#### 3.1.2 Secondary Outcomes

Tests if the city is split more along income lines than caste, acknowledging the high correlation between the two

Produce a chloropleth of local segregation indices

### 3.2. Results

## 4. Conclusion and Discussion 

The limitations of this study arose primarily from data availability and quality.
Ideally, this study would have been conducted at the Ward Level


Methodologically, we must also acknowledge that many of these measures are, relatively speaking, new in the literature and each suffers from limitations unique to them. For example, even though Hong's measure meets compositional invariance criteria, it suffers from MAUP issues, something that may be worsened by the alternatingly arbitrary and non-arbitrary basis on which shrids are defined in SHRUG. 

{{< pagebreak >}}

## References

::: {#refs}
:::

{{< pagebreak >}}

## Appendix
