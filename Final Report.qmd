---
title: "Housing market and employment discrimination in the Mumbai Metropolitan Region - a spatial analysis of caste-based segregation"
author: "Aaditya Warrier"
bibliography: references.bib
format: pdf
editor: visual
editor_options: 
  chunk_output_type: console
---

```{r setup, echo = FALSE, include = FALSE, warning=FALSE}
library(tidyverse)
library(sf)
library(knitr)
opts_chunk$set(warning = FALSE, echo = FALSE)
```

## 1. Introduction

Mumbai, India's financial and commercial capital, is both its wealthiest city and its most diverse. The former headquarters of the Bombay Presidency during British rule, the city had long been home to large minority communities from around the province, but was always dominated by Maharashtrians and Gujaratis, the ethnic natives of the region. Post-independence, however, the city was (and continues to be) shaped by waves of immigration from across the state and the country, exponentially growing its population and consequently its urbanized area to accommodate these new residents. Large swathes of land to the north of the city, previously independent towns or villages, were annexed by administration. Mumbai is no stranger to expansion - indeed, the original island city owes its mere existence to land reclamation by the British - but its scale and scope in the past few decades has been unprecedented. In 1951, the city covered 231.5 $km^2$ and housed 2.3 million people. By 2011, the city's metropolitan region (henceforth shortened as MMR) spanned 6,328 $km^2$ with 22.8 million people, with the city proper housing 12.2 million over a mere 603 $km^2$. Today, Maharashtrians and Gujaratis only make up 42% and 19% of the city's population respectively.

These rapid changes in demography have brought with them a significant rise in ethnic, religious, and caste tension. Combined with rising real estate prices - the highest in India and in the top 20 globally - these have manifested in *severe* social segregation in the housing market. Despite recent laws that have attempted to curb the practice [@Koppikar_2023], many apartment buildings have been found outright barring Muslims, lower caste individuals, and specific ethnicities; failing that, they ban "non-vegetarians" in order to circumvent the law, as lower/middle caste Hindus and religious minorities alike are more likely to be non-vegetarian. [@TNN]. From Gujarati "colonies" in suburban neighborhoods like Vile Parle and Ghatkopar to the ghetoization of Muslims in Mumbra, many in the city live segregated lives.

When not motivated by self-preservation as a social minority - as is the case for Christians strangehold on housing in Bandra, for example - the common thread uniting these blatantly discriminatory acts is likely a strong **casteist** sentiment. With housing societies going as far as having separate elevators for residents and "servants" [@IndiaTimes_2020], we see a strong revulsion of living in, or even sharing any space, as people with perceived undesirable characteristics, linked to the idea of the "impurity" of lower castes. Even when ethnic solidarity has been observed amidst rising tensions, caste fractures have run high Mumbai; for example, the Shiv Sena, a powerful, right-wing, pro-nativist political party that came into power a few decades ago rallying under preferential treatment for Maharashtrians, covertly opposed affirmative action for lower caste Maharashtrians (see Worli riots, opposition to Mandal Commission). This discrimination can extend to "natives" of the region as well - numerous stories have emerged in recent years [@Staff_2021] of Maharshtrians being denied housing by Gujaratis (on average, local Gujarati communities are wealthier and of higher caste than Maharashtrians).

This project hence aims to explore to what extent Dalits, Adivasis, and other lower caste groups have been pushed to the margins of the city, as well as how current demographics of the region reflect the characteristics of immigrating populations. The primary objective of the project is descriptive rather than inferential or predictive, and aims to obtain a spatially-informed understanding of segregation both within Mumbai's exurbs and between the city and its fringes. Spatial segregation in Mumbai's housing has been well-established in the literature [@Shaban2021]; however, little analysis has been conducted on segregation in the wider metropolitan region, outside the boundaries of the city proper. In a city with limited land space, segregation effectively incentivizes those shut out of its restrictive market to either live in slum-like informal tenements or to seek housing in far-flung satellite cities in the MMR. Not coincidentally, real estate prices also tend to decrease as one moves northwards and eastwards from the old city, further pushing lower-income individuals (who are disproportionately lower-caste and/or Muslim) outwards. This has the potential for severe business impacts [see @BHARATHI2023110951] - daily commutes of three hours or more are not uncommon in the region, as a majority of employment tends to be concentrated in industrial areas and business districts in the city proper, even today. There is also evidence that these exurbs are less developed and have reduced access to public services[pre-print from @Asher2023ResidentialSA], further underlining the necessity of this study.

## 2. Data

The data used in this study comes from The Socioeconomic High-resolution Rural-Urban Geographic Platform for India Project (abbrv. SHRUG). SHRUG is an open access repository that aims to link hundreds of Indian datasets comprising socio-economic surveys, censuses, and environmental studies with common geographic identifiers. Owing to the nation's size and diversity, Indian record-keeping is notoriously inconsistent, with formats, naming conventions, and even languages often differing within the same state. SHRUG obtains a level of standardization and geographic granularity that cannot be found in any single government dataset - by splitting the nation into 576,153 uniform areal units termed "shrids" and reaggregating all variables to these, it provides a largely consistent framework facilitating analysis at a deeper level than states, districts and sub-districts. This is the primary reason that this project utilizes **2011 Population Census Abstract (PCA), Socio-Economic and Caste Survey (SECC), and Economic Cenus (EC) Data** [@pcindia; @ecindia; @almn2021] over more recent data like the National Family Health Survey from 2019-21 - cleaning the latter to a level acceptable for analysis would have been a months-long project, as it is not currently available in SHRUG.

The 2011 PCA, EC, and SECC datasets are the most current census data available for India; although usually conducted decennially, the 2021 census was postponed due to COVID and other political reasons. As stored at the shrid and subdistrict level in SHRUG, they contain a multitude of variables on employment, occupation, literacy, property ownership, and consumption, as well as demographic information like gender, caste, income, and education status. Key variables of interest were the Scheduled Caste/Scheduled Tribe (SC/ST) population percentages, home/land ownership shares, and employment/business ownership by different classes (including OBCs). Note that SC/ST are government designations for Dalits and Adivasis, while OBCs refer to a range of lower and middle castes considered socio-economically "backward".

Surprisingly missing from the dataset was a breakdown of religions and ethnicities in each shrid. This could have provided additional nuance to our analysis, especially when looking at how they intersect with caste; contrary to popular belief, many non-Hindu Indians also have caste distinctions, while an ethnic breakdown could contextualize discrimination in terms of the familiarity of individuals with specific sub-castes not present in their native regions.

### 2.1 Data Cleaning

As SHRUG stores district/sub-district data separately from shrid-level data, with no linking variables between the two, finding the specific shrids that comprised the MMR outside of the city proper proved a challenge. This was compounded by the fact that the MMR is defined by the Municipal Corporation and Councils that comprise it, the exact boundaries for which occasionally span multiple state-level districts or include very small portions of specific sub-districts. To rectify this problem as much as possible, the spatial intersection (using the st_interescts predicate) between the most relevant sub-districts of the MMR and all shrids in the PCA data was computed. This, however, missed out on a few areas of interest, most notably the majority of the municipal council of Khopoli, while including a few parcels of rural land that were not relevant. The cleaned dataset contained 1273 shrids with a population totaling roughly 22.1 million - this was deemed an acceptable enough difference from the true population of 22.8 million.

Another issue encountered was that the city proper was only comprised of two shrids, each spanning the Mumbai City and Mumbai Suburban districts respectively. The authors of SHRUG note this as an issue in their documentation - specifically, that breaking up census data into shrids was challenging in and around major cities, given the occasional lack of detail in the census - and this hampered some of the comparative analysis that was planned with regards to segregation in the city vs. the rest of the MMR.

Finally, there were some missing shrids in the EC and SECC datasets as compared to the PCA dataset; specifically, 42 shrids were missing from SECC and another 60 from EC. As a result, only PCA variables are available for those vs. the full set of PCA, EC SECC variables for the rest.

### 2.2 Exploration

```{r echo  =FALSE, warning=FALSE}
mmr_shrid <- readRDS("data/cleaned/mmr_shrid.rds")

all_surveys_mmr_shrid <- readRDS("data/cleaned/all_surveys_mmr_shrid.rds")


mmr_subdist <- readRDS("data/cleaned/mmr_subdist.rds")

tab <- mmr_shrid |>
  filter(is.na(shrid2)) |>
  summarize(sc_pop = (sum(pc11_pca_p_sc) / sum(pc11_pca_tot_p))* 100,
            st_pop = (sum(pc11_pca_p_st) / sum(pc11_pca_tot_p)) *100, 
            total = sc_pop + st_pop) |>
  as_tibble() |>
  select(-geometry) |>
  rbind(mmr_shrid |>
          filter(!is.na(shrid2)) |>
  summarize(sc_pop = (sum(pc11_pca_p_sc) / sum(pc11_pca_tot_p))* 100,
            st_pop = (sum(pc11_pca_p_st) / sum(pc11_pca_tot_p)) *100,
            total = sc_pop + st_pop) |>
     as_tibble() |>
  select(-geometry)) |>
  rbind(c(11.81399, 9.352859, 21.16685)) |>
  rbind(c(0.166 *100, 0.086 *100, (0.166 + 0.086)*100))


rownames(tab) <- c("Mumbai (city proper)", "MMR (excluding city proper)", "Maharashtra", "India")

tab |>
  rownames_to_column() |>
  kable(digits = 2, col.names = c("Region", "SC Population (% of total)", "ST Population (% of total)", "Combined SC/ST Population (% of total)"), 
        row.names = TRUE, caption = "Caste demography of the MMR vs. India")
```

Table 1 demonstrates that immigration to Mumbai and the MMR has not been reflective of the broader caste population of India or of the state. This is not particularly surprising for the ST population, who primarily inhabit forested regions, but a marked difference must be noted in the SC population, who theoretically should be evenly spread out. What is notable for STs is the stark difference in population percentages between the city proper and the rest of the urban region, indicating their exclusion from the city.

```{r}

tab_2 <- all_surveys_mmr_shrid |>
  filter(is.na(shrid2)) |>
  summarize(sc_pop = (sum(ec13_count_sc) / sum(ec13_count_all))* 100,
            st_pop = (sum(ec13_count_st) / sum(ec13_count_all)) *100,
            obc_pop = (sum(ec13_count_obc) / sum(ec13_count_all)) * 100) |>
  as_tibble() |>
  select(-geometry) |>
  rbind(all_surveys_mmr_shrid |>
          filter(!is.na(shrid2)) |>
  summarize(sc_pop = (sum(ec13_count_sc) / sum(ec13_count_all))* 100,
            st_pop = (sum(ec13_count_st) / sum(ec13_count_all)) *100,
            obc_pop = (sum(ec13_count_obc) / sum(ec13_count_all)) * 100) |>
  as_tibble() |>
  select(-geometry)) |>
  rbind(c(9.817733, 4.166227, 34.17379)) 

rownames(tab_2) <- c("Mumbai (city proper)","MMR (excluding city proper)", "India")

tab_2 |> 
  rownames_to_column() |>
  kable(digits = 2, col.names = c("Region", "SC (% of total firms)", 
                                  "ST (% of total firms)", 
                                  "OBC (% of total firms)"), 
        row.names = TRUE, caption = "Firm ownership by caste/class in the MMR")  |>
  kableExtra::kable_styling(font_size = 9)
```

```{r echo = FALSE, warning=FALSE, fig.size = 10}

library(patchwork)

ggplot() + 
  geom_sf(data = mmr_shrid |>
  # filter(shrid2 != ) |>
  mutate(sc_st_prop = (pc11_pca_p_sc + pc11_pca_p_st) / 
                                  pc11_pca_tot_p),
  aes(fill = sc_st_prop), color = ifelse(is.na(mmr_shrid$shrid2), "red", NA)) +
  scale_fill_viridis_c() + 
  labs(fill = "Proportion of SC/ST residents", title = "Figure 1: Shrid-wise map of SC/ST populations") 
  # theme(legend.position ="bottom", legend.title = element_text(size = 7),
  #       legend.text = element_text(size = 7),
  #       axis.text = element_text(size = 7),
  #       legend.key.size = unit(0.6, "cm")) 
```

This finding is confirmed by Figure 1. As before, note that all of the city proper is are two large shrids, outlined in red on the map. We observe a pattern of increasing SC/ST percentages as we move northwards from the original island city, with higher percentages observed in the Kalyan and Bhiwandi sub-districts as well as parts of Vasai/Virar (see Figure 3 in Appendix for a subdistrict-wise map). A particuarly high percentage is observed in the easternmost sub-district of Karjat, as well as the southermost parts of Alibag/Pen sub-districts in the south. This reinforces initial speculation as to the pricing out of these minorities towards northern and eastern parts of the MMR.

Table 2 shows us that lower and middle caste groups, especially OBCs, have a drastically lower ownership of firms in the city as compared to India, with a sharp difference even between Mumbai and the exurbs. This is less pronounced for SCs, but note that SCs and STs are far more disenfranchised as populations and have much lower capital ownership in general, so may not the best metric to evaluate.

```{r}
mmr_shrid_2 <- mmr_shrid |>
  filter(shrid2 != "11-27-518-99999-802794")

A = spdep::mat2listw(st_touches(mmr_shrid_2, sparse=FALSE), zero.policy = TRUE)

broom::tidy(spdep::geary.test((mmr_shrid_2$pc11_pca_p_sc + mmr_shrid_2$pc11_pca_p_st) / 
                                  mmr_shrid_2$pc11_pca_tot_p, A)) |>
  select(estimate1, p.value) |>
  kable(digits = 3, col.names = c("Geary's C", "P-value"),
        caption = "Shrid-level Geary's C test: SC/ST population percentages") |>
  kableExtra::kable_styling(font_size = 9)
  
```

Conducting a hypothesis test for Geary's C shows us clear evidence of positive spatial autocorrelation (value \< 1), indicating that a shrid with a high SC/ST proportion is likely to neighbor a shrid with a very similar proportion. These set the guiding context within which we will conduct our analysis and provide additional evidence for claims made in the introduction.

## 3. Spatial Analysis

### 3.1 Methodology

#### 3.1.1 Primary Outcome

The primary outcome of this study is a set of segregation statistics to spatially describe caste/tribe-based segregation in the MMR at a shrid-level. These will comprise of the aspatial global dissimilarity index, Reardon and O'Sullivan's set of surface-based spatial dissimilarity indices [@Reardon_2004], and Morrill's areal-based, spatially-adjusted dissimilarity index \[@Morrill_1992\], comparing SC and ST population percentages vs. all other individuals as well as firm ownership for SC, ST, and OBC populations vs. all others.

The conventional aspatial global dissimilarity index, although still widely used in sociological, economics, and public health research, has long been considered insufficient to accurately capture the effects of spatial correlation. This is primarily due to the so-called "checkerboard problem" [@Reardon_2004], where high exposure (i.e. at small distances from each other and easily able to interact), but non-clustered distributions of two groups can appear more segregated than they are. In a city like Mumbai, where expansions of its territory and local geography have been shaped significantly by different waves of immigration, this could greatly affect our estimates, so must be accounted for. The specific choice of Reardon and O'Sullivan's measure was because a similar, although not identical, kernel-based spatial index has been used in the Indian context earlier to some success [see @Haque_2021, which explores spatial segregation in Kolkata and Bengaluru using @Feitosa_2007's index]. However, neither the aspatial index nor Reardon and O'Sullivan's global dissimilarity index satisfy the compositional invariance criterion [@Barron_Hall_Rich_Arias_2023; @Reardon_2004] - the implications of this for the analysis of the region are discussed in further detail in the Evaluation. Reardon and O'Sullivan also require tuning of the kernel/smoothing algorithm, which I was unfamiliar with and had to rely on the software's best guess. Therefore, I also included Morrill's measure, which is a more easily intepretable, direct modification of the aspatial index, but suffers from the MAUP (see Secondary Outcome for details).

All of these metrics were calculated using the *seg* package in R, developed in part by O'Sullivan. As *seg* has been temporarily unavailable on CRAN since Feb 2024 due to dependency issues, I used an older version of the package available on the archive, for which the tar.gz can be found in the project repo. I also had to update some code in the package itself, as some lines were outdated given changes in syntax for some R functions; these changes are described in the Appendix.

Significance will be tested using a pseudo-significance "p-value" measure, computed on random permutation tests of dissimilarity across different spatial arrangements of the region [using a procedure similar to @Feitosa_2007 pp. 309-310]. This will be conducted using the *OasisR* package - as this package depended on *seg*, it is also no longer available on CRAN, so an archived version from Dec 2023 has been used (in repo).

#### 3.1.2 Secondary Outcome

The secondary outcome of this study is the same set of spatial statistics, but computed at the census' sub-district level. This is primarily to account for potential variability in results resulting from the modifiable areal unit problem (MAUP), also known as the "grid" problem [@Feitosa_2007]. Most spatial data is stored in an areal format - indeed, so was the data for this study - but the exact choice of area unit, including its shape and its size, can have large impacts on how one estimates segregation. This is especially true for data where we can only compute a simple spatial weight matrix to quantify interactions between areal units, as is the case for our data, rather than an intensity of interaction function. For example, smaller units are likely to be more homogeneous so could show a smaller segregation effect than larger ones. Neither the aspatial or Morrill's measure avoid this issue, and although Reardon and O'Sullivan largely avoid it through kernel-based population estimates, it may still be informative to see how estimate differ.

### 3.2. Results

```{r}
prim <- tibble(d_sc = c(0.2414745), d_st = c(0.525149), d_comb = c(0.2799382)) |>
  kable(digits = 3, col.names = c("SC", "ST", "Combined SC/ST"),
        caption = "Primary Outcome Results - Shrid-level Indices")
```

```{r}
tibble(d_sc = 0.1023268, d_st = 0.4275618, d_comb = 0.1536606) |>
  kable(digits = 3, col.names = c("SC", "ST", "Combined SC/ST"),
        caption = "Secondary Outcome Results - Subdistrict-level Indices")

tibble()
```

## 4. Conclusion and Discussion

The limitations of this study arose primarily from data availability and quality. Ideally, this study would have been conducted at the Ward Level

Methodologically, we must also acknowledge that many of these measures are, relatively speaking, new in the literature and each suffers from limitations unique to them. For example, even though Hong's measure meets compositional invariance criteria, it suffers from MAUP issues, something that may be worsened by the alternatingly arbitrary and non-arbitrary basis on which shrids are defined in SHRUG.

{{< pagebreak >}}

## References

::: {#refs}
:::

{{< pagebreak >}}

## Appendix

```{r}
ggplot() +
  geom_sf(data = mmr_subdist |>
  # filter(shrid2 != ) |>
  mutate(sc_st_prop = (pc11_pca_p_sc + pc11_pca_p_st) /
                                  pc11_pca_tot_p),
  aes(fill = sc_st_prop)) +
  scale_fill_viridis_c() +
  labs(fill = "Proportion of SC/ST residents", title = "Figure 3: Subdistrict-wise map of SC/ST populations") 
  
```

```{r}
# ggplot() + 
#   geom_sf(data = mmr_subdist |>
#   # filter(shrid2 != ) |>
#   mutate(sc_st_prop = (pc11_pca_p_sc + pc11_pca_p_st) / 
#                                   pc11_pca_tot_p),
#   aes(fill = sc_st_prop)) +
#   scale_fill_viridis_c() + 

```
